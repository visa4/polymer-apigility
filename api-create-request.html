<script>
    window.PolymerApigility = window.PolymerApigility || {};

    PolymerApigility.ApiCreateRequestBehaviorImp = {

        properties: {

            headers: {
                type: Object,
                value: function() {
                    return {};
                }
            }
        },

        /**
         * An object that maps header names to header values
         *
         * @return {Object}
         */
        requestHeaders: function(headers) {
            var mergedHeaders = {};

            if (this.$.ironAjax.headers !== null && this.$.ironAjax.headers instanceof Object) {
                for (var header in this.$.ironAjax.headers) {
                    mergedHeaders[header] = this.$.ironAjax.headers[header].toString();
                }
            }

            if (this.headers !== null && this.headers instanceof Object) {
                for (var header in this.headers) {
                    mergedHeaders[header] = this.headers[header].toString();
                }
            }

            if (headers !== null && headers instanceof Object) {
                for (var header in headers) {
                    mergedHeaders[header] = headers[header].toString();
                }
            }

            return mergedHeaders;
        },

        /**
         * Create request
         *
         * @param method string
         * @param data object
         * @param headers object
         * @param query object
         */
        createRequest: function (method, data, headers, query) {
            // TODO check this.$.ironAjax exist
            this.$.ironAjax.url = this.buildUrl();
            this.$.ironAjax.method = (method) ? method : this.method;
            this.$.ironAjax.body = (data) ? data : null;
            this.$.ironAjax.headers = this.requestHeaders(headers);
            this.$.ironAjax.params = (query) ? query : {};
            this.$.ironAjax.generateRequest();
        },

        buildUrl: function() {
            throw 'Must be override method element implementation';
        }
    };
</script>