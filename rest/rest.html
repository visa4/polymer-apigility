<link rel="import" href="../../iron-ajax/iron-ajax.html">
<link rel="import" href="../api-config-behavior.html">
<link rel="import" href="../api-create-request-behavior.html">
<link rel="import" href="../auth/auth-error-handler-aware-behavior.html">
<link rel="import" href="rest-url-behavior.html">
<link rel="import" href="rest-response-behavior.html">
<link rel="import" href="rest-paginable-behavior.html">

<dom-module id="apigility-rest">
  <template>
    <iron-ajax id="ironAjax" content-type="{{contentType}}"></iron-ajax>
  </template>
  <script>
    'use strict';

    Polymer({
      is: 'apigility-rest',

      properties: {

        contentType: {
          type: String
        }
      },

      behaviors: [
        PolymerApigility.ApiConfigBehaviorImp,
        PolymerApigility.ApiCreateRequestBehaviorImp,
        PolymerApigility.AuthErrorHandlerAwareBehaviorImp,
        PolymerApigility.RestUrlBehaviorImp,
        PolymerApigility.RestResponseBehaviorImp,
        PolymerApigility.RestPaginableBehaviorImp
      ],

      observers: [
        'get(identify, rootUrl)'
      ],

      get: function() {
        // TODO add query params
        this.createRequest('GET');
      },

      getAll: function() {
        // TODO add query params and merge
        this.createRequest('GET', null, null, {"page": this.page, "page_size": this.pageSize});
      },

      post: function (data) {
        this.createRequest('POST', data);
      },

      put: function (data) {
        this.createRequest('PUT', data);
      },

      patch: function (identify, data) {
        this.createRequest('PATCH', data);
      },

      delete: function(identify) {
        this.createRequest('DELETE');
      }
    });
  </script>

</dom-module>