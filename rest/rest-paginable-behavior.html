<script>

  window.PolymerApigility = window.PolymerApigility || {};

  PolymerApigility.RestPaginableBehaviorImp = {

    properties: {

      page: {
        type: Number,
        value: 1
      },

      pageSize: {
        type: Number,
        value: 10
      },

      pageCount: {
        type: Number,
        readOnly: true,
        notify: true
      },

      totalItems: {
        type: Number,
        readOnly: true,
        notify: true
      }
    },


    observers: [
      'changePage(page)',
      'changePageSize(pageSize)'
    ],

    ready: function () {
      this.$.ironAjax.addEventListener('response', this.paginableHandler.bind(this));
    },

    attached: function () {
      this.finishLifeCicle = true;
    },

    /**
     *
     * @param e
     */
    paginableHandler: function (e) {
      if (e.detail.response._embedded) {
        this._setPageCount(e.detail.response.page_count);
        this._setTotalItems( e.detail.response.total_items);
      }
    },

    changePage: function (page) {
      this.getUsers();
    },

    changePageSize: function (pageSize) {
     this.getUsers();
    },

    getUsers: function () {
      if (!this.finishLifeCicle) {
        return;
      }
      this. getAll();
    }
  };
</script>