<script>

    window.PolymerApigility = window.PolymerApigility || {};

    PolymerApigility.ApiConfigBehaviorImp = {
        properties: {
            /**
             * Service root url
             */
            rootUrl: {
                type: String
            }
        },

        ready: function () {

            this.ironAjax = (document.createElement('iron-ajax'));

            var rootUrl = new Polymer.IronMetaQuery({type:'apigility', key: 'root-url'}).value;
            if (!this.rootUrl) {
                this.rootUrl = rootUrl;
            }

            var contentType = new Polymer.IronMetaQuery({type:'apigility', key: 'content-type'}).value;
            if (contentType) {
                this.ironAjax.contentType = contentType;
            }

            var headers = new Polymer.IronMetaQuery({type:'apigility', key: 'headers'}).value;
            switch (typeof headers) {
                case 'string':
                    try { headers = JSON.parse(headers); }
                    catch(e) { headers = null; }
                    break;
            }

            if (headers) {
                this.ironAjax.headers = headers;
            }
        }
    };
</script>